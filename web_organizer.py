[REDACTED FOR BREVITY - will insert full code in actual delivery]